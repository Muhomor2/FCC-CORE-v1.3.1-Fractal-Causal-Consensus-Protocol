# FCC-CORE v1.3.x — Formal Specification (v1.3.1)

## 1. Ideal growth (Menger sponge)

- Level: `t = 0,1,2,...`
- Scale: `s(t) = 3^{-t}`
- Ideal cell count: `N_ideal(t) = 20^t`
- Ideal structure: Menger sponge generated by subdividing a cube into `3×3×3`,
  removing 7 central subcubes, leaving 20.

## 2. Realized set and defects

Let `M_t` be the ideal set of cells at level `t` and `M'_t ⊆ M_t` be realized cells.

Defects:
`D_t = M_t \ M'_t`
and `δ_t = |D_t|`.

## 3. Defect probability

Defect probability at step `t → t+1`:
`p_defect(t, E_heal(t)) = p0 · (1+ε)^{-t} · exp(-k·E_heal(t))`

with parameters:
- `p0 ∈ (0,1)` (base defect rate)
- `ε > 0` (decay of defectivity with level)
- `k ≥ 0` (sensitivity to healing reserve)

## 4. Energy model

Per level `t+1` geometric deficit:
`ΔE_geom(t+1) = δ_{t+1} · 20^{-(t+1)}`

Energy update (conceptual):
- `α ∈ [0,1]` fraction of deficit routed to healing
- `η ∈ [0,1]` healing efficiency
- `β ∈ [0,1]` leak from `E_heal` to entropy

The implementation follows the BC5 plan with strict accounting:
- healing uses a discrete per-cell cost `cost = 20^{-(t+1)}`
- residual budget is carried forward (see `docs/healing_operator.md`)

## 5. Invariant

`E_total(t+1) = E_total(t)` (tested in code).

## 6. Initial conditions

Default initial state (used in reference implementation):
- `M'_0 = {unit cube}`
- `E_geom(0)=1`, `E_heal(0)=0`, `E_entropy(0)=0`

